<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head profile="http://gmpg.org/xfn/11">
    <title>List Express is alive again!  Plus, some details on the lifeline of the NNTP/FTP servers. &mdash; In Valid Logic</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Endlessly expanding technology" />
    <meta name="author" content="Ken Robertson" />
    <meta name="generator" content="jekyll" />

    <link href="/css/site.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/css/pygments/trac.css" rel="stylesheet" type="text/css" media="screen" />

    <link href="/atom.xml" rel="alternate" title="Ken Robertson's Atom Feed" type="application/atom+xml" />
    <link href="/rss.xml" rel="alternate" title="Ken Robertson's RSS Feed" type="application/rss+xml" />

    <link rel='index' title='In Valid Logic' href='http://invalidlogic.com/' />
  </head>

<body>
  <div id="container" class="group">

    <h1><a href="http://invalidlogic.com">In Valid Logic</a></h1>
    <div id="bubble"><p>Endlessly expanding technology</p></div>

    <div id="content" class="group">
      <h2>List Express is alive again!  Plus, some details on the lifeline of the NNTP/FTP servers.</h2>

<div class="main">
  <p>Quite glad to be able to say that work has begun again on List Express, the mailing list component for Community Server.&nbsp; I&rsquo;d originally done a proof of concept back around October of last year, but it was very crude and based on a very early version of CS (I think it was just on like v1.0 beta 1).</p>


<p>Beginning work on it again, we are going back and starting from scratch.&nbsp; The POC (proof of concept, not piece of crap) was really the first application we tried writing that used Community Server outside of the web context, and since then, we&rsquo;ve made major strides to make it easier (from within CS) and to figure out how the application should do it.</p>


<p>With the original POC, it primarily just used the base objects from Community Server, and used all of its own stored procedures and data providers for interacting with the database.&nbsp; This quickly proved to be problematic as there was a lot of maintenance that had to be done to keep it up to speed will CS was still in its early stages.&nbsp; An additional flaw was the lack of caching, so queries went to the database every time, causing degrading performance if used in a production environment.</p>


<p>Since then, by building the NNTP and FTP servers for Community Server, a lot of changes have been incorporated into CS to make it easier and we&rsquo;ve learned a lot of lessons as what to and what not to do.&nbsp; The NNTP/FTP servers were a lot smaller than LE, so taking them from concept to full implementation was a lot easier.&nbsp; In this time, we went through many revisions as far as getting to link directly with CS&rsquo;s data providers (no dependence on own sprocs), caching (improved performance), and threading (finding how to be multi-threaded while scaling, managing memory, not dependent on blocking calls).&nbsp; This brought up a few new issues that we sought to improve.&nbsp; For one, they directly used the data providers, by passing the CS accessor classes (Forums, Users, etc) which normally handled the caching.&nbsp; They had to have their own classes to ge the data and manage the caching (more work).&nbsp; This was primarily because the accessor classes in CS v1.0 were still rather dependent on the HttpContext, which caused problems.</p>


<p>When building Community Server v1.1, a lot of work went into removing the direct dependency on the HttpContext and using our own CSContext instead.&nbsp; The CSContext could then be manually instanciated and initialized by the application and specific to the current thread for only the lifetime of the command.&nbsp; This allowed using something like &ldquo;CSContext.Current&rdquo; to be safe in a multi-threaded environment.&nbsp; For the NNTP/FTP servers for CS v1.1, they were updated to use the built in CS accessor classes, which simplified the code specific for those applications and still allowed full data caching.</p>


<p>The FTP server also saw an overhaul in terms of how it interacts with the specific application components of Community Server.&nbsp; For v1.0, the FTP server was built only with working with the Galleries in mind.&nbsp; While working on CS v1.1, we began talking about writing additonal applications, such as a download.com style &ldquo;File Gallery&rdquo; application and that it would be great if it could be used with the FTP server as well.&nbsp; While in the process of building the v1.1 release of the FTP server, the specifics of how it worked while traversing the directory structure and working with files was abstracted.&nbsp; We created an &ldquo;FtpApplicationProvider&rdquo; provider,&nbsp;and &ldquo;FtpDirectory&rdquo; and &ldquo;FtpFile&rdquo; objects.&nbsp; The core of the FTP server worked only with the FtpDirectory and FtpFile objects, while using a specific FtpApplicationProvider to manage returning and creating of these objects.&nbsp; So, it wants a listing of files in the current directory.&nbsp; The core figures out the directory, says &ldquo;get files&rdquo;, the FtpDirectory says &ldquo;ok, we are in this provider, get some FtpFiles from it&rdquo;, and the application provider selects the pictures (pretending we&rsquo;re in the Galleries right now), puts them into FtpFiles and returns it.&nbsp; This adds&nbsp;a number of tiers in terms of the steps to perform data operations, but it allows the FTP server to uniquely work with multiple applications, giving the application the control over how the interaction works, all without any necessary changes to the FTP server core.</p>


<p>Now, getting back to List Express, after my little tangent, all of the past work from the original POC and the development of the NNTP/FTP servers will prove vital in rebuilding List Express.&nbsp; List Express will be built to be extremely high performance, dynamically working with multiple applications (forums, blogs, and galleries), leverage as much out of Community Server&rsquo;s core as it can (without sacraficing performance, a few things will be custom), and must be fully reliable and redundant.</p>


<p>It&rsquo;ll probably be about another week before I sit down and actually start writing code specific for LE, since one of the lessons learned from the POC was that the compexity is far greater than the NNTP/FTP servers.</p>


<p>For one, LE will be integrating into existing infrastructures.&nbsp; It has to integrate with their current email servers.&nbsp; Email is one thing where configurations vary greatly, in terms of the applications used, the way their topology is laid out, and the amount of trust they want to have.&nbsp; Some will be more wary about adding in direct event sinks into their production SMTP server, so we&rsquo;ll allow them to put the email into a catch-all mailbox that LE picks up the email from.&nbsp; Or, LE will have its own back-end SMTP server that the emails will get relayed to.&nbsp; This requires a lot of sensativity to ensure that any configuration they come up with can be met in one way or another.</p>


<p>Second, the logic involved in the processing is far more complicated and less centralized.&nbsp; With NNTP/FTP, they are command driven.&nbsp; You sit, wait for a command, get one, go off, process it, then return and wait for the next.&nbsp; Carried through all the commands is a context that tells you whether they&rsquo;ve logged in, what user they are, their current directory/newsgroup, etc.&nbsp; Your center is command processor, you always leave a central point, do work, then return there.&nbsp; Through each step is the information context.&nbsp; In LE, it is more procedural.&nbsp; There is no direct&nbsp;interaction with the user, so you get an email, need to validate the To, need to validate the sender, need to validate the post it is a reply to, then add it to the database, then send out any other emails.&nbsp; At each check, you need other routes such as if it is to a valid forum, or the sender isn&rsquo;t authorized, etc.&nbsp; There is no easy&nbsp;central point while processing a message that you branch out from and then return to.&nbsp; This primarily leads to complexity in terms of organization.&nbsp; If you just dive in and do it, then later realize you need to add this, then add that, it gets far less structured and far more difficult to maintain and keep logical.&nbsp; So, you need to design out all your different work flows (lovely DFDs)&nbsp;and make sure you capture everything in them so that you can make the organization as clear as possible.</p>


<p>So, in short and for conclusion, much has been happening with the NNTP/FTP servers, and much is starting to happen with List Express.&nbsp; We have high hopes for LE and are putting a lot of time and energy into ensuring it meets every expectation and idea we&rsquo;ve come up with.</p>




</div>

<div class="meta group">
  <div class="signature">
    <p>Friday, May 27, 2005</p>
  </div>	
  <div class="tags">
    &nbsp;
  </div>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'invalidlogic'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2005/05/27/community-server-v1-1-rc1-released/" title="Previous post: Community Server v1.1 RC1 released!">Community Server v1.1 RC1 released!</a></div>
  
  
  
    <div class="next"><a class="next" href="/2005/05/28/obfuscateemails-module-for-cs-v1-1/" title="Next post: ObfuscateEmails Module for CS v1.1">ObfuscateEmails Module for CS v1.1</a> &rarr;</div>
  
</div>
    </div>

    <div id="sidebar">
      <h3>About</h3>
      <div class="textwidget">
        This is the personal blog of Ken Robertson.  I'm a developer at <a href="http://involver.com/">Involver</a> working in Ruby/Rails.  In a former life, I worked in .NET for many years and since moved on.<br/>
        <br/>
        Now, I get to make Rails scale, cook all day long with chef, and experiment with building highly concurrent systems.<br/>
        <br/>
        In my spare time, I like to build things.  I like to experiment with different technologies to find how they best fit onto my utility belt.<br/>
        <br/>
        I sometimes blog.  You'll find those things here.<br/>
        <br/>
        I sometimes code.  You'll find those on <a href="http://github.com/krobertson">Github</a>.<br/>
      </div>

      <h3>Search</h3>
      <form method="get" action="http://www.google.com/search">
        <div>
          <label class="screen-reader-text" for="s">Search for:</label>
          <input type="text" id="s" name="q" value="" />
          <input type="hidden" name="q" value="site:invalidlogic.com" />
          <input type="submit" id="searchsubmit" value="Search" />
        </div>
      </form>

      <h3>Recent Posts</h3>
      <ul>
        
          <li><a href="/2011/02/11/how-we-did-a-datacenter-migration-with-no-downtime/">How we did a datacenter migration with no downtime</a></li>
        
          <li><a href="/2011/02/07/how-a-deprecated-method-can-take-down-a-process/">How a deprecated method can take down a process</a></li>
        
          <li><a href="/2011/01/19/love-your-dependency-management/">Love your dependency management</a></li>
        
          <li><a href="/2010/12/08/progress-through-iterating/">Progress through iterating</a></li>
        
          <li><a href="/2010/10/25/tool-enlightenment-part-2/">Tool Enlightenment, Part 2</a></li>
        
    	</ul>
    </div>

  </div>

  <div id="footer">
    <p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a></p>
  </div>
</body>
</html>