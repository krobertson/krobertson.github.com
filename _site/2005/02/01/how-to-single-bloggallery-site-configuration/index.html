<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head profile="http://gmpg.org/xfn/11">
    <title>How To: Single Blog/Gallery Site Configuration &mdash; In Valid Logic</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Endlessly expanding technology" />
    <meta name="author" content="Ken Robertson" />
    <meta name="generator" content="jekyll" />

    <link href="/css/site.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/css/pygments/trac.css" rel="stylesheet" type="text/css" media="screen" />

    <link href="/atom.xml" rel="alternate" title="Ken Robertson's Atom Feed" type="application/atom+xml" />
    <link href="/rss.xml" rel="alternate" title="Ken Robertson's RSS Feed" type="application/rss+xml" />

    <link rel='index' title='In Valid Logic' href='http://invalidlogic.com/' />
  </head>

<body>
  <div id="container" class="group">

    <h1><a href="http://invalidlogic.com">In Valid Logic</a></h1>
    <div id="bubble"><p>Endlessly expanding technology</p></div>

    <div id="content" class="group">
      <h2>How To: Single Blog/Gallery Site Configuration</h2>

<div class="main">
  <p><strong>Updated:</strong> This method is vastly out of date.&nbsp; It was only for Community Server v1.0.&nbsp; Please see <a href="http://qgyen.net/archive/2006/07/14/Qgyen.ExtendedUrlMapping-for-CS-v2.1.aspx">http://qgyen.net/archive/2006/07/14/Qgyen.ExtendedUrlMapping-for-CS-v2.1.aspx</a>&nbsp;for the new method in CS v2.0 and v2.1.</p>


<p>Community Server was designed around the idea of multi-user community featuring forums, blogs, and photo galleries.&nbsp; This is a great and easy setup for people running community sites, but there are still a lot of people who run their own personal site and want the same blog/gallery functionality.</p>


<p>The purpose of this article to show how to configure Community Server to run utilizing only a single blog and gallery.&nbsp; This should also show easy it is to do simple customizations utilizing the Community Server framework.&nbsp; Configuring a single blog/gallery can be done in only 7 simple steps and utilizing a customized SiteUrls.config file</p>


<p><strong><u>Downloads</u></strong></p>


<p>Download the following file: singlesite.zip</p>


<p><strong><u>Instructions</u></strong></p>


<ol><li>Create the blog and gallery you want to be your primary blog/gallery.&nbsp; Go to the Admin area, click on either Blogs or Galleries, and go to Manage Blogs/Manage Galleries.&nbsp; Create a blog named something like &ldquo;Blog&rdquo; and Gallery named something like &ldquo;Photos&rdquo;.&nbsp; After creating your blog/gallery, you will want to click on it and take note of the &quot;Blog Name&quot; field in Blogs and &quot;Application Key&quot; field in Galleries.&nbsp; You will need this later.<br /><br /></li><li>Overwrite the SiteUrls.config file in your Community Server directory with the one included in the zip..<br /><br /></li><li>Open up the SiteUrls.config and configure the folder you want your blog/gallery to be accessible from.&nbsp; Look under &ldquo;locations&rdquo; for the &ldquo;weblogs&rdquo; and &ldquo;galleries&rdquo; entries.&nbsp; Change them to your wishes.&nbsp; The default in the included file is /blog/ for your blog, and /photos/ for your gallery (/photos/ is the default in Community Server for a multi-user site as well)..<br /><br /></li><li>Rename the blogs and photos folder in your Community Server directory to match the settings in the SiteUrls.config.&nbsp; If you are using the default settings included in the file, just rename the &ldquo;blogs&rdquo; folder to &ldquo;blog&rdquo;..<br /><br /></li><li>Copy the included sample_web.config to the /photos/ directory, name it web.config, and open it up.&nbsp; Change the value for the &ldquo;ApplicationKey&rdquo; entry to match the Application Key setting for your photo gallery..<br /><br /></li><li>The blogs already has its own web.config, so copy the section from the sample or from the gallery file and paste it into the web.config in the blogs directory.&nbsp; Change the value for the &ldquo;ApplicationKey&rdquo; entry to match the Application Key setting for you blog..<br /><br /></li><li>Open up the root level web.config and find the &lt;httpHandlers&gt; section.&nbsp; Any entries with a path starting with &quot;blogs/&quot; or &quot;photos/&quot; should be changed to reflect&nbsp;the directories you used in step 4.&nbsp; These are used for RSS feeds and the Metablog API support for the blogs.</li></ol>


<p><strong><u>Background</u></strong></p>


<p>Customizing Community Server in this way is achieved by modifying its URL schema to remove&nbsp;the directory level from the URLs that normally specifies which blog/gallery to load.&nbsp; If you compare the SiteUrls.config entry for &ldquo;gallery_ViewGallery&rdquo; from the default file and the included file, you will notice a few differences:</p>


<ul><li>The path&nbsp;attribute is missing a {0} parameter which was a directory. </li><li>The pattern attribute is missing a ([\w\.-]+) section which was used in the regular expression to grab the Application Key. </li><li>The vanity attribute is missing the &ldquo;App=$1&rdquo; section, which was used to pass the Application Key to the page that handles the rewritten URL.</li></ul>


<p>This affectively changes Community Server&rsquo;s URL rewriting to no longer specify which blog/gallery to load.&nbsp; It will no longer look for the Application Key in the URL the user uses the access the site, and the Application Key will no longer be included in links generated by Community Server itself.</p>


<p>Since one is no longer specified using the URL, we still need to tell Community Server which one needs to be loaded.&nbsp; This is where the web.config file comes in.&nbsp; In the absence of a &ldquo;App&rdquo; setting in the query string, Community Server will fall back on reading the ApplicationKey from the AppSettings section of the web.config.&nbsp; These files are placed in both the blog and photos directory in order to narrow their scope to just the blog and photos areas.</p>




</div>

<div class="meta group">
  <div class="signature">
    <p>Tuesday, February 01, 2005</p>
  </div>	
  <div class="tags">
    &nbsp;
  </div>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'invalidlogic'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2005/01/22/welcome/" title="Previous post: Welcome!">Welcome!</a></div>
  
  
  
    <div class="next"><a class="next" href="/2005/02/02/community-server-rc1-and-howto-setup-single-bloggallery-sites/" title="Next post: Community Server RC1 and Howto setup single blog/gallery sites!">Community Server RC1 and Howto setup single blog/gallery sites!</a> &rarr;</div>
  
</div>
    </div>

    <div id="sidebar">
      <h3>About</h3>
      <div class="textwidget">
        This is the personal blog of Ken Robertson.  I'm a developer at <a href="http://involver.com/">Involver</a> working in Ruby/Rails.  In a former life, I worked in .NET for many years and since moved on.<br/>
        <br/>
        Now, I get to make Rails scale, cook all day long with chef, and experiment with building highly concurrent systems.<br/>
        <br/>
        In my spare time, I like to build things.  I like to experiment with different technologies to find how they best fit onto my utility belt.<br/>
        <br/>
        I sometimes blog.  You'll find those things here.<br/>
        <br/>
        I sometimes code.  You'll find those on <a href="http://github.com/krobertson">Github</a>.<br/>
      </div>

      <h3>Search</h3>
      <form method="get" action="http://www.google.com/search">
        <div>
          <label class="screen-reader-text" for="s">Search for:</label>
          <input type="text" id="s" name="q" value="" />
          <input type="hidden" name="q" value="site:invalidlogic.com" />
          <input type="submit" id="searchsubmit" value="Search" />
        </div>
      </form>

      <h3>Recent Posts</h3>
      <ul>
        
          <li><a href="/2011/04/12/serving-static-content-via-post-from-nginx/">Serving Static Content Via POST From Nginx</a></li>
        
          <li><a href="/2011/02/16/our-pain-points-with-ec2/">Our pain points with EC2 and how our moved solved them</a></li>
        
          <li><a href="/2011/02/11/how-we-did-a-datacenter-migration-with-no-downtime/">How we did a datacenter migration with no downtime</a></li>
        
          <li><a href="/2011/02/07/how-a-deprecated-method-can-take-down-a-process/">How a deprecated method can take down a process</a></li>
        
          <li><a href="/2011/01/19/love-your-dependency-management/">Love your dependency management</a></li>
        
    	</ul>
    </div>

  </div>

  <div id="footer">
    <p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a></p>
  </div>
</body>
</html>