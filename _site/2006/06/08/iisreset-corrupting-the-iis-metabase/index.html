<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head profile="http://gmpg.org/xfn/11">
    <title>IISReset corrupting the IIS metabase &mdash; In Valid Logic</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Endlessly expanding technology" />
    <meta name="author" content="Ken Robertson" />
    <meta name="generator" content="jekyll" />

    <link href="/css/site.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/css/pygments/trac.css" rel="stylesheet" type="text/css" media="screen" />

    <link href="/atom.xml" rel="alternate" title="Ken Robertson's Atom Feed" type="application/atom+xml" />
    <link href="/rss.xml" rel="alternate" title="Ken Robertson's RSS Feed" type="application/rss+xml" />

    <link rel='index' title='In Valid Logic' href='http://invalidlogic.com/' />
  </head>

<body>
  <div id="container" class="group">

    <h1><a href="http://invalidlogic.com">In Valid Logic</a></h1>
    <div id="bubble"><p>Endlessly expanding technology</p></div>

    <div id="content" class="group">
      <h2>IISReset corrupting the IIS metabase</h2>

<div class="main">
  <p>Recently, I'd been having an issue where running iisreset would cause the SSL certificate I had assigned to a site I was developing to stop working.  There wouldn't be any error message or anything to indicate something bad happened.  All that would happen is I'd try and access the page over SSL and the browser would hang for a while before timing out.</p>




<p>I'd posted about the issue over at <a href="http://forums.iis.net/thread/1308440.aspx">forums.iis.net</a> and had received some useful feedback.</p>




<p>For starters, I'd found the useful <a href="http://www.microsoft.com/technet/prodtechnol/windowsserver2003/technologies/webapp/iis/ssldiags.mspx">SSL Diagnostic Utility</a> and it told me that the private key for the certificate had been corrupted.  A little workaround was to open mmc, add the certificate snap-in, delete the certificate, reimport it, open IIS snap-in, and reassign the certificate to the site.  Kind a pain, but did fix it.  Though I was still curious if iisreset was actually the cause, or if it was something else.</p>




<p><a href="http://blogs.msdn.com/david.wang/default.aspx">David Wang</a>, refers to <a href="http://blogs.msdn.com/david.wang/archive/2005/04/27/IIS_Configuration_Mysteriously_Disappear.aspx">a blog post</a>, which intern links to <a href="http://www.msusenet.com/archive/topic.php/t-1869432174.html">a newsgroup post</a> about some of the potential caveats to using iisreset and its potential to lose configuration information.</p>




<p>In short, iisreset is bad.  Running it on production servers is especially bad, since it'd be best to just recycle the app pool.  But even on development machines using just Windows XP (and IIS 5.1), it can still cause problems.  You maybe fire off iisreset to quickly restart an application and get back to work, only find it is now not responding and you have to stop your coding marathon to now figure out what happened and how to resolve it.</p>




</div>

<div class="meta group">
  <div class="signature">
    <p>Thursday, June 08, 2006</p>
  </div>	
  <div class="tags">
    &nbsp;
  </div>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'invalidlogic'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
    // var disqus_identifier = 'unique_dynamic_id_1234';
    // var disqus_url = 'http://example.com/permalink-to-page.html';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2006/06/07/my-hope-for-visual-studio-2008/" title="Previous post: My hope for Visual Studio 2008">My hope for Visual Studio 2008</a></div>
  
  
  
    <div class="next"><a class="next" href="/2006/06/09/for-all-you-soccer-lovers/" title="Next post: For all you soccer lovers">For all you soccer lovers</a> &rarr;</div>
  
</div>
    </div>

    <div id="sidebar">
      <h3>About</h3>
      <div class="textwidget">
        This is the personal blog of Ken Robertson.  I'm a developer at <a href="http://involver.com/">Involver</a> working in Ruby/Rails.  In a former life, I worked in .NET for many years and since moved on.<br/>
        <br/>
        Now, I get to make Rails scale, cook all day long with chef, and experiment with building highly concurrent systems.<br/>
        <br/>
        In my spare time, I like to build things.  I like to experiment with different technologies to find how they best fit onto my utility belt.<br/>
        <br/>
        I sometimes blog.  You'll find those things here.<br/>
        <br/>
        I sometimes code.  You'll find those on <a href="http://github.com/krobertson">Github</a>.<br/>
      </div>

      <h3>Search</h3>
      <form method="get" action="http://www.google.com/search">
        <div>
          <label class="screen-reader-text" for="s">Search for:</label>
          <input type="text" id="s" name="q" value="" />
          <input type="hidden" name="q" value="site:invalidlogic.com" />
          <input type="submit" id="searchsubmit" value="Search" />
        </div>
      </form>

      <h3>Recent Posts</h3>
      <ul>
        
          <li><a href="/2011/02/16/our-pain-points-with-ec2/">Our pain points with EC2 and how our moved solved them</a></li>
        
          <li><a href="/2011/02/11/how-we-did-a-datacenter-migration-with-no-downtime/">How we did a datacenter migration with no downtime</a></li>
        
          <li><a href="/2011/02/07/how-a-deprecated-method-can-take-down-a-process/">How a deprecated method can take down a process</a></li>
        
          <li><a href="/2011/01/19/love-your-dependency-management/">Love your dependency management</a></li>
        
          <li><a href="/2010/12/08/progress-through-iterating/">Progress through iterating</a></li>
        
    	</ul>
    </div>

  </div>

  <div id="footer">
    <p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a></p>
  </div>
</body>
</html>