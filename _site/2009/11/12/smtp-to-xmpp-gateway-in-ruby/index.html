<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head profile="http://gmpg.org/xfn/11">
    <title>SMTP to XMPP gateway in Ruby &mdash; In Valid Logic</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Endlessly expanding technology" />
    <meta name="author" content="Ken Robertson" />
    <meta name="generator" content="jekyll" />

    <link href="/css/site.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/css/pygments/trac.css" rel="stylesheet" type="text/css" media="screen" />

    <link href="/atom.xml" rel="alternate" title="Ken Robertson's Atom Feed" type="application/atom+xml" />
    <link href="/rss.xml" rel="alternate" title="Ken Robertson's RSS Feed" type="application/rss+xml" />

    <link rel='index' title='In Valid Logic' href='http://invalidlogic.com/' />
  </head>

<body>
  <div id="container" class="group">

    <h1><a href="http://invalidlogic.com">In Valid Logic</a></h1>
    <div id="bubble"><p>Endlessly expanding technology</p></div>

    <div id="content" class="group">
      <h2>SMTP to XMPP gateway in Ruby</h2>

<div class="main">
  <p>Sometimes its just fun to write an app for the sole purpose of playing around with something new.</p>




<p>I'd heard of <a href="http://www.mailhooks.com/">Mail Hooks</a> before, which is a service that turns an email into an HTTP POST.  I'd been wanting a reason to play with XMPP, and found a way to.  I'd been wanting to find a better way to test email functionality in Telligent Community/Enterprise but with live messages.  Typically, this is annoying to set up since you need live email accounts, and need to set up the Windows service for them, and so on.  On a dev machine, often want to do it quick and easy, and will have to regularly re-do the configuration as you switch or rebuild databases.  Using HTTP POSTs for messages also wouldn't work, because most of the developers are behind firewalls or NAT routers (like myself).  I needed something else to send the message.</p>




<p>So what better than an SMTP to XMPP gateway, and then have a simple desktop app I fire up when I want to test messages that acts as an XMPP client.  ~120 lines of ruby and more lines than that in a WPF app, and I got an easy to use solution.</p>




<p>The SMTP server is a very simplistic implementation, but it maintains a list of contacts that are online and allows anything@username.domain.com to be routed to them.  I set it up with ejabberd and have it allow new user registration, and it auto-notifies the SMTP service user.  When the SMTP service gets a notification of a new user, it automatically subscribes to their presence updates, and the client is set up to auto-accept the request.</p>




<p>When whenever the desktop app receives a new message, it sends it over to Telligent Community just as if our normal Windows service did.</p>




<p>Feel free to use the Ruby code as you wish.</p>




<script src="http://gist.github.com/233480.js"></script>




</div>

<div class="meta group">
  <div class="signature">
    <p>Thursday, November 12, 2009</p>
  </div>	
  <div class="tags">
    &nbsp;
  </div>
</div>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2009/11/08/coming-soon-trunks/" title="Previous post: Coming Soon: Trunks">Coming Soon: Trunks</a></div>
  
  
  
    <div class="next"><a class="next" href="/2009/11/13/trunks-a-quick-preview/" title="Next post: Trunks, a quick preview">Trunks, a quick preview</a> &rarr;</div>
  
</div>
    </div>

    <div id="sidebar">
      <h3>About</h3>
      <div class="textwidget">
        This is the personal blog of Ken Robertson.  I'm a developer at <a href="http://involver.com/">Involver</a> working in Ruby/Rails.  In a former life, I worked in .NET for many years and since moved on.<br/>
        <br/>
        In my spare time, I like to build things.  I like to experiment with different technologies to find how they best fit onto my utility belt.<br/>
        <br/>
        I sometimes blog.  You'll find those things here.<br/>
        <br/>
        I sometimes code.  You'll find those on <a href="http://github.com/krobertson">Github</a>.<br/>
      </div>

      <h3>Search</h3>
      <form method="get" action="http://www.google.com/search">
        <div>
          <label class="screen-reader-text" for="s">Search for:</label>
          <input type="text" id="s" name="q" value="" />
          <input type="hidden" name="q" value="site:invalidlogic.com" />
          <input type="submit" id="searchsubmit" value="Search" />
        </div>
      </form>

      <h3>Recent Posts</h3>
      <ul>
        
          <li><a href="/2011/01/19/love-your-dependency-management/">Love your dependency management</a></li>
        
          <li><a href="/2010/12/08/progress-through-iterating/">Progress through iterating</a></li>
        
          <li><a href="/2010/10/25/tool-enlightenment-part-2/">Tool Enlightenment, Part 2</a></li>
        
          <li><a href="/2010/10/14/tool-enlightenment/">Tool Enlightenment</a></li>
        
          <li><a href="/2010/10/08/involver-team-and-matz/">Involver Team and Matz</a></li>
        
    	</ul>
    </div>

  </div>

  <div id="footer">
    <p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a></p>
  </div>
</body>
</html>