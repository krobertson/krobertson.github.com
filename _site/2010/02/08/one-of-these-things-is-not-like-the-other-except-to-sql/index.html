<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
  <head profile="http://gmpg.org/xfn/11">
    <title>One of these things is not like the other, except to SQL &mdash; In Valid Logic</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="description" content="Endlessly expanding technology" />
    <meta name="author" content="Ken Robertson" />
    <meta name="generator" content="jekyll" />

    <link href="/css/site.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/css/pygments/trac.css" rel="stylesheet" type="text/css" media="screen" />

    <link href="/atom.xml" rel="alternate" title="Ken Robertson's Atom Feed" type="application/atom+xml" />
    <link href="/rss.xml" rel="alternate" title="Ken Robertson's RSS Feed" type="application/rss+xml" />

    <link rel='index' title='In Valid Logic' href='http://invalidlogic.com/' />
  </head>

<body>
  <div id="container" class="group">

    <h1><a href="http://invalidlogic.com">In Valid Logic</a></h1>
    <div id="bubble"><p>Endlessly expanding technology</p></div>

    <div id="content" class="group">
      <h2>One of these things is not like the other, except to SQL</h2>

<div class="main">
  <p>Was recently working on an issue that was so perplexing, that I <em>almost</em> had <a href="http://pentonizer.com/">David Penton</a>, our resident SQL expert stumped.</p>

<p>We had an issue with some username handling and it ended up boiling down to there we could go into SQL Server, run this query, and get a result when you'd normally expect it to not match:</p>

<p>[sql light="true"]select 1 where N'ß' = N'ss'[/sql]</p>

<p>After that, I was truly stumped.  I'd Googled everything I could think of any came up empty.  Had I known what the <a href="http://en.wikipedia.org/wiki/German_alphabet#Sharp_s">German sharp S</a> was, life would have been easier.  Come to find out through <a href="http://www.ureader.com/message/1343195.aspx">some sources</a>, that some of the SQL standards (in this case, SQL92 is referenced) call for the German sharp S is translated down to "ss" in string comparisons.  So although it might seem like a bug, it is to-spec.  Oracle is also reported as working this way.</p>

<p>To work around the behavior, one option is a <a href="http://connect.microsoft.com/SQLServer/feedback/details/341130/-and-ss-are-not-equal#tabs">workaround function</a> for SQL Server which essentially has you convert the string to a binary column and store it.  This may be outside what you can do in your application though, as in ours, we'd need to update every place that does string comparisons on the username as well as altering the ASP.NET Membership tables and stored procedures.</p>

<p>An alternative is to change your database collation to use one that is more binary dependent such as Latin1_General_BIN.  This will treat ß and 'ss' separately, though also be aware since it is binary, it is case insensitive and some behaviors such as sorting may also change.</p>

<p>A topic like this is important for any developer for a few reasons:</p>

<p>First, being in the US, it is easy to be ignorant of other culture's language handling.  You may work to add resource labels so your application can be translated and such, but every so often you will find behaviors related to internalization that perplex you because you've never heard of the German sharp S (as in this case).</p>

<p>Second, when its an issue in SQL and you're in doubt, look at collation first.  SQL Server has a <em>huge</em> list of collations, and each one does something different.  Its either a behavior with the one you're using, or the user is using a collation you haven't tried (tested) before.</p>

<p>And finally... need to try harder to stump Penton.  It can be done!</p>

</div>

<div class="meta group">
  <div class="signature">
    <p>Monday, February 08, 2010</p>
  </div>	
  <div class="tags">
    &nbsp;
  </div>
</div>

<div class="paginator">
  
    <div class="previous">&larr; <a class="previous" href="/2010/02/05/hiring-in-todays-market/" title="Previous post: Hiring in today's market">Hiring in today's market</a></div>
  
  
  
    <div class="next"><a class="next" href="/2010/02/12/migrating-datacenters-how-to-forward-traffic/" title="Next post: Migrating datacenters: How to forward traffic">Migrating datacenters: How to forward traffic</a> &rarr;</div>
  
</div>
    </div>

    <div id="sidebar">
      <h3>About</h3>
      <div class="textwidget">
        This is the personal blog of Ken Robertson.  I'm a developer at <a href="http://involver.com/">Involver</a> working in Ruby/Rails.  In a former life, I worked in .NET for many years and since moved on.<br/>
        <br/>
        In my spare time, I like to build things.  I like to experiment with different technologies to find how they best fit onto my utility belt.<br/>
        <br/>
        I sometimes blog.  You'll find those things here.<br/>
        <br/>
        I sometimes code.  You'll find those on <a href="http://github.com/krobertson">Github</a>.<br/>
      </div>

      <h3>Search</h3>
      <form method="get" action="http://www.google.com/search">
        <div>
          <label class="screen-reader-text" for="s">Search for:</label>
          <input type="text" id="s" name="q" value="" />
          <input type="hidden" name="q" value="site:invalidlogic.com" />
          <input type="submit" id="searchsubmit" value="Search" />
        </div>
      </form>

      <h3>Recent Posts</h3>
      <ul>
        
          <li><a href="/2010/10/25/tool-enlightenment-part-2/">Tool Enlightenment, Part 2</a></li>
        
          <li><a href="/2010/10/14/tool-enlightenment/">Tool Enlightenment</a></li>
        
          <li><a href="/2010/10/08/involver-team-and-matz/">Involver Team and Matz</a></li>
        
          <li><a href="/2010/09/16/you-got-rvm-and-git-in-my-command-prompt/">You got RVM and git in my command prompt!</a></li>
        
          <li><a href="/2010/09/08/the-future-of-papercut/">The Future of Papercut</a></li>
        
    	</ul>
    </div>

  </div>

  <div id="footer">
    <p>The Journalist template by <a href="http://lucianmarin.com/" rel="designer">Lucian E. Marin</a></p>
  </div>
</body>
</html>