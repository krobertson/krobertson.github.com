--- 
wordpress_id: 192
layout: post
title: Windows Live Writer and detecting style when using Community Server
wordpress_url: /archive/windows-live-writer-and-detecting-style-when-using-community-server/
---

<p>Some people have emailed me about having trouble with Windows Live Writer detecting the style of their CS site, some of them thinking it was because they were using my ExtendedUrlMapper. I'd run into the issue with it detecting my site's style as well, so this morning, as I was messing around with some stuff, I decided to take a look into it...</p> <p>The cause is actually quite simple.</p> <p>Cache!</p> <p>The time when you are going to have the problem mostly is when you first add the blog to WLW.&nbsp; This is because it will hit the front page of your blog to check for RSD support.&nbsp; So even if the front page data wasn't cached, it will be now.&nbsp; Then it will try to detect the style by making a post, refreshing the page, and then removing the post.&nbsp; The problem is that the old post listing will still be there.&nbsp; So the key is to make it so that when it gets the front page of the site, the post data should not be in the cache already.&nbsp; Here is what to do:</p> <ol> <li>Add the Community Server site to Windows Live Writer (if you haven't done already) and let it fail to detect the settings.  <li>Force your site to restart, by recycling the application pool, running iisreset, or simply touch the site's web.config.  <li>Hit a page on your site that is not the front page (!).&nbsp; This will force the application to start again, and keep WLW from eating up the delay.  <li>In WLW, go to the View menu and select Update Weblog Style.</li></ol> <p>Once that is done, you will be able to view your post using your blog's style!&nbsp; Simply select View and then Web Preview.</p> <p>Hopefully with the final release they fix some of its CSS url handling.&nbsp; For me, none of the style images show up (such as my header) because the CSS for the image is a relative path rather than the absolute URL.</p>
         
